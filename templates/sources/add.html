{% extends "base.html" %}
{% load item_tags %}
{% load utils_tags %}

{% block title %}Add Source{% endblock %}

{% block mainbar %}

{% if mode == "item" %}
<div class="panel panel-default">
  <div class="panel-heading expander-in">
    <h4 class="panel-title">{{ item }}{% if item.parent %} of {{ item.parent }}{% endif %} <span class="glyphicon"></span></h4>
  </div>
  <div class="panel-body">
{{ item|typeset_body }}
  </div>
</div>
{% elif mode == "draft" %}
<div class="panel panel-default">
  <div class="panel-heading expander-in">
    <h4 class="panel-title">{{ item }}{% if item.parent %} of {{ item.parent }}{% endif %} <span class="glyphicon"></span></h4>
  </div>
  <div class="panel-body">
{{ item|typeset_body }}
  </div>
</div>
{% endif %}

<h4>Source data</h4>
<div id="source-edit"></div>

<h4>Preview</h4>
<div id="source-preview"></div>

<h4>Search Results</h4>
<div id="source-search"></div>

{% endblock mainbar %}

{% block bodybottom %}

{% include 'include/js-scripts.html' with cookie=True only %}

<script type="text/javascript">

(function() {

  teoremer.setupCsrf();

  var source = new teoremer.SourceItem();

  new teoremer.SourceEditView({
    el: $('#source-edit'),
    model: source,
    mode: {{mode|to_json}}
  });

  new teoremer.SourceRenderView({
    el: $('#source-preview'),
    model: source
  });

  new teoremer.LiveSourceSearchView({
    el: $('#source-search'),
    sourceModel: source,
    mode: {{mode|to_json}}
  });

})();

</script>

{% endblock %}
